System.register(["@tanstack/query-core","jotai"],function(Q){"use strict";var P,p,C,E,h;return{setters:[function(d){P=d.QueryClient,p=d.QueryObserver,C=d.InfiniteQueryObserver,E=d.isCancelledError},function(d){h=d.atom}],execute:function(){Q({atomWithInfiniteQuery:M,atomWithQuery:A});const d=Q("queryClientAtom",h(new P));function A(y,w=a=>a(d)){const a=new WeakMap,l=h(n=>{const e=w(n),s=typeof y=="function"?y(n):y,o=new p(e,s),i=o.getCurrentResult();i.data===void 0&&s.keepPreviousData&&a.has(e)&&(i.data=a.get(e));let u=null;const b=()=>new Promise(c=>{u=c}),m=h(i.data===void 0&&s.enabled!==!1?b():i);let r=null;const v=c=>{if(!(c.isFetching||!c.isError&&c.data===void 0)){if(!u&&!r)throw new Error("setting result without mount");u&&(u(c),u=null),r&&r(c),c.data!==void 0&&a.set(e,c.data)}};let t=null,f;const g=()=>{!r&&t&&(clearTimeout(f),t(),t=null),s.enabled!==!1&&(r?o.refetch({cancelRefetch:!0}).then(r):t=o.subscribe(v)),r||(f=setTimeout(()=>{t&&(t(),t=null)},1e3))};return g(),m.onMount=c=>(r=c,t?clearTimeout(f):g(),()=>{r=null,t&&t()}),{resultAtom:m,makePending:b,startQuery:g}});return h(n=>{const{resultAtom:e}=n(l),s=n(e);if(s.isError)throw s.error;return s.data},(n,e,s)=>{const{resultAtom:o,makePending:i,startQuery:u}=n(l);switch(s.type){case"refetch":e(o,i()),u()}})}function M(y,w=a=>a(d)){const a=h(l=>{const n=w(l),e=typeof y=="function"?y(l):y,s=n.defaultQueryOptions(e),o=new C(n,s),i=o.getCurrentResult();let u=null;const b=h(i.data===void 0&&e.enabled!==!1?new Promise(t=>{u=t}):i);let m=()=>{throw new Error("setting result without mount")};const r={isMounted:!1,unsubscribe:null},v=t=>{t.isFetching||!t.isError&&t.data===void 0||t.isError&&E(t.error)||(u?(setTimeout(()=>{var f;r.isMounted||((f=r.unsubscribe)==null||f.call(r),r.unsubscribe=null)},1e3),u(t),u=null):m(t))};return e.enabled!==!1&&(r.unsubscribe=o.subscribe(v)),b.onMount=t=>(m=t,r.isMounted=!0,e.enabled!==!1&&!r.unsubscribe&&(r.unsubscribe=o.subscribe(v),v(o.getCurrentResult())),()=>{var f;return(f=r.unsubscribe)==null?void 0:f.call(r)}),{options:e,resultAtom:b,observer:o,state:r}},(l,n,e)=>{var s;const{options:o,resultAtom:i,observer:u,state:b}=l(a);if(o.enabled!==!1)switch(e.type){case"refetch":{n(i,new Promise(()=>{})),b.isMounted||((s=b.unsubscribe)==null||s.call(b),b.unsubscribe=null),u.refetch(e.payload).then(m=>{n(i,m)});return}case"fetchPreviousPage":{u.fetchPreviousPage();return}case"fetchNextPage":{u.fetchNextPage();return}}});return h(l=>{const{resultAtom:n}=l(a),e=l(n);if(e.isError)throw e.error;return e.data},(l,n,e)=>n(a,e))}}}});
